**Blockchain.js**

**working with blockchains**

-   Read smart contract state variables

-   Write data(Change state variables) via making transactions

| Packages                    | Descriptions                                                                                |
|-----------------------------|---------------------------------------------------------------------------------------------|
| web3                        | Ethereum Javascript API for interacting with ethereum nodes, using a HTTP or IPC connection |
| ethereumjs-tx               | A simple module for creating, manipulating and signing ethereum transactions                |
| moment                      | Parse, validate, manipulate, and display dates and times in JavaScript                      |
| truffle-privatekey-provider | Private Key provider for Web3. Used to sign transactions by provider private key            |

**Imported functions from /timeserver/utilities.js**

| Imported functions      | Descriptions                                                                                                                 |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------|
| checkEq                 | Check if two given values are of equal value and equal type                                                                  |
| getTimeServerTime       | Get timeserver time. This function is controlled by env settings to get localtime or fakeservertime                          |
| isEmpty                 | Check if the given value is valid(not undefined or null or empty string or a string ‘undefined’                              |
| testInputTime           | Test if the given time is a valid time, which is 12 digits of numbers YYYYMMDDHHMM and representing a current or future time |
| asyncForEach            | A function to execute asynchronous callback functions in the order of given array items                                      |
| asyncForEachTsMain      | Same as asyncForEach with different name                                                                                     |
| asyncForEachMint        | Same as asyncForEach with different name, outer loop                                                                         |
| asyncForEachMint2       | Same as asyncForEach with different name, inner loop                                                                         |
| asyncForEachCFC         | Same as asyncForEach with different name                                                                                     |
| asyncForEachAbCFC       | Same as asyncForEach with different name                                                                                     |
| asyncForEachAbCFC2      | Same as asyncForEach with different name                                                                                     |
| asyncForEachOrderExpiry | Same as asyncForEach with different name                                                                                     |
| checkTargetAmounts      | Check if given each balance already is above each targetAmount respectively                                                  |
| breakdownArray          | Breakdown a given amount into pieces that is less than given maximum amount                                                  |
| isInt                   | Check if given value is an integer                                                                                           |
| isIntAboveZero          | Same as above isInt and it also checks if given value is above zero                                                          |
| checkBoolTrueArray      | Check if given value is a boolean true value                                                                                 |
| makeFakeTxHash          | Make fake transaction hash                                                                                                   |

**Imported functions from /timeserver/mysql.js**

| Imported functions           | Descriptions                                                                                                                                 |
|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| addActualPaymentTime         | Add actual payment time into rows with given symbol and payablePeriodEnd time inside income_arrangement table                                |
| mysqlPoolQueryB              | Write / read data from database then returns a promise                                                                                       |
| setFundingStateDB            | Set p_state, (Optionally p_CFSD and p_CFED) values inside product table with given symbol                                                    |
| setTokenStateDB              | Set p_tokenState, (optionally also p_lockuptime and p_validdate) inside product table for given symbol                                       |
| getTokenStateDB              | Get p_tokenState, p_lockuptime, and p_validdate for given symbol inside product table                                                        |
| addProductRow                | Add a product into product table in database                                                                                                 |
| addAssetRecordRowArray       | Add an array of asset records into investor_assetRecord table                                                                                |
| getCtrtAddr                  | Get contract address from database with given symbol and contract type                                                                       |
| getForecastedSchedulesFromDB | Get forcasted schedules including ia_time, ia_single_Forecasted_Payable_Income_in_the_Period from income_arrangement table with given symbol |
| getAllSmartContractAddrs     | Get all smart contract addresses from smart_contracts table with given symbol                                                                |
| updateIAassetRecordStatus    | Update ia_assetRecord_status to 1 for given symbol and ia_Payable_Period_End is 0 inside income_arrangement table                            |

**Imported functions from /timeserver/envVariables.js**

| Imported variables | Descriptions                                                             |
|--------------------|--------------------------------------------------------------------------|
| addrHelium         | Address of Helium contract                                               |
| addrRegistry       | Address of Registry contract                                             |
| addrProductManager | Address of Product Manager contract                                      |
| blockchainURL      | IP address of our backend Ethereum node                                  |
| admin              | An Ethereum externally owned address for signing transactions            |
| adminpkRaw         | The private key for the above address                                    |
| gasLimitValue      | The gas limit for sending transactions                                   |
| gasPriceValue      | The gas price for sending transactions                                   |
| isLivetimeOn       | If true, use local machine time, else if false, use fakeservertime value |
| backendAddrChoice  | To choose which externally owned address to use for signing transactions |

**Imported variables from /test_CI/zTestParameters.js**

| Imported variables   | Type             | Descriptions                                             |
|----------------------|------------------|----------------------------------------------------------|
| assetOwnerArray      | Array of strings | An array of Ethereum EOAs for testing                    |
| assetOwnerpkRawArray | Array of strings | An array of private keys for the above EOAs respectively |

**Imported functions from /ethereum/contracts/zsetupData.js**

| Imported variables | Type            | Descriptions                                |
|--------------------|-----------------|---------------------------------------------|
| Helium             | integer         | Compiled Helium smart contract              |
| Registry           | integer         | Compiled Registry smart contract            |
| AssetBook          | boolean         | Compiled Assetbook smart contract           |
| TokenController    | Boolean         | Compiled Token Controller smart contract    |
| HCAT721            | Boolean         | Compiled HCAT token smart contract          |
| CrowdFunding       | Boolean         | Compiled Crowdfunding smart contract        |
| IncomeManager      | Boolean         | Compiled Income Manager smart contract      |
| ProductManager     | Boolean         | Compiled Product Manager smart contract     |
| wlogger            | Function object | For displaying different logging levels     |
| excludedSymbols    | Array of string | An array of symbols to skip(to be excluded) |

**Functions defined within Blockchain.js**

Note. in the following functions. The naming indicates the returned value types:

If the name starts with ‘is’, then it returns a boolean.

| Function Names                | Parameters                                                                                                                                                                                                                                                                                                                                                       | Descriptions                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| addPlatformSupervisor         | platformSupervisorNew, addrHeliumContract                      | Add a new platform supervisor address into Helium contract                    |
| addCustomerService            | platformSupervisorNew, addrHeliumContract                                                                                                                                                                                                                                                                                                                        | Add a new customer service address into Helium contract                                                                                                                                                                                                                                                                                                                                                                                                                            |
| checkPlatformSupervisor       | eoa, addrHeliumContract                                                                                                                                                                                                                                                                                                                                          | Check if the given eoa has platform supervisor authorization according to the Helium contract                                                                                                                                                                                                                                                                                                                                                                                      |
| checkCustomerService          | eoa, addrHeliumContract                                                                                                                                                                                                                                                                                                                                          | Check if the given eoa has customer service authorization according to the Helium contract                                                                                                                                                                                                                                                                                                                                                                                         |
| checkArgumentsHelium          | argsHelium                                                                                                                                                                                                                                                                                                                                                       | Check the given arguments inside argsHelium object then returns a boolean value indicating check result                                                                                                                                                                                                                                                                                                                                                                            |
| checkHeliumCtrt               | addrHeliumContract, managementTeam                                                                                                                                                                                                                                                                                                                               | Check if the contract deployed on the given address relly is the correct Helium contract by checking contract variables                                                                                                                                                                                                                                                                                                                                                            |
| deployHeliumContract          | managementTeam                                                                                                                                                                                                                                                                                                                                                   | Deploy a copy of the compiled Helium contract                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| deployRegistryContract        | addrHeliumContract                                                                                                                                                                                                                                                                                                                                               | Deploy a copy of the compiled Registry contract                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| deployProductManagerContract  | addrHeliumContract                                                                                                                                                                                                                                                                                                                                               | Deploy a copy of the compiled Product Manager contract                                                                                                                                                                                                                                                                                                                                                                                                                             |
| setRestrictions               | registryContractAddr, authLevel, maxBuyAmountPublic, maxBalancePublic, maxBuyAmountPrivate, maxBalancePrivate                                                                                                                                                                                                                                                    | Set new regulation restrictions on given Registry contract                                                                                                                                                                                                                                                                                                                                                                                                                         |
| deployAssetbooks              | eoaArray, addrHeliumContract                                                                                                                                                                                                                                                                                                                                     | Deploy assetbook contracts with given array of EOAs                                                                                                                                                                                                                                                                                                                                                                                                                                |
| deployCrowdfundingContract    | argsCrowdFunding                                                                                                                                                                                                                                                                                                                                                 | Deploy crowdfunding contract using argument object’s properties as parameters:                                                                                                                                                                                                                                                                                                                                                                                                     |
| checkArgumentsCFC             | argsCrowdFunding                                                                                                                                                                                                                                                                                                                                                 | Check if the above mentioned argument object has correct property values for deploying crowdfunding contracts                                                                                                                                                                                                                                                                                                                                                                      |
| checkCrowdfundingCtrt         | crowdFundingAddr                                                                                                                                                                                                                                                                                                                                                 | Check if the contract at given address has correct variable values. If yes, then the contract at that address is a valid crowdfunding contract                                                                                                                                                                                                                                                                                                                                     |
| checkDeploymentCFC            | crowdFundingAddr, argsCrowdFunding                                                                                                                                                                                                                                                                                                                               | Check above, then check if the crowdfunding contract deployment was successful with correct state variable values                                                                                                                                                                                                                                                                                                                                                                  |
| checkArgumentsTCC             | argsTokenController                                                                                                                                                                                                                                                                                                                                              | Check if the argument has correct values for token controller contract deployment                                                                                                                                                                                                                                                                                                                                                                                                  |
| deployTokenControllerContract | argsTokenController                                                                                                                                                                                                                                                                                                                                              | Deploy token controller contract with given arguments                                                                                                                                                                                                                                                                                                                                                                                                                              |
| checkTokenControllerCtrt      | tokenControllerCtrtAddr                                                                                                                                                                                                                                                                                                                                          | Check if the given address has a correct token controller contract deployed upon                                                                                                                                                                                                                                                                                                                                                                                                   |
| checkDeploymentTCC            | tokenControllerAddr, argsTokenController                                                                                                                                                                                                                                                                                                                         | Check above, then check if the token controller contract deployment was successful with correct state variable values                                                                                                                                                                                                                                                                                                                                                              |
| checkArgumentsHCAT            | argsHCAT721                                                                                                                                                                                                                                                                                                                                                      | Check if the argument has correct values for HCAT token contract deployment                                                                                                                                                                                                                                                                                                                                                                                                        |
| fromAsciiToBytes32            | asciiString                                                                                                                                                                                                                                                                                                                                                      | Convert an ASCII string to a bytes32 format                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| fromBytes32ToAscii            | bytes32String                                                                                                                                                                                                                                                                                                                                                    | Convert a bytes32 string to an ASCII string                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| deployHCATContract            | argsHCAT721                                                                                                                                                                                                                                                                                                                                                      | Deploy HCAT contract with given arguments                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| checkHCATTokenCtrt            | tokenCtrtAddr                                                                                                                                                                                                                                                                                                                                                    | Check if the given address has a correct HCAT token contract deployed upon                                                                                                                                                                                                                                                                                                                                                                                                         |
| checkDeploymentHCAT           | tokenCtrtAddr, argsHCAT721                                                                                                                                                                                                                                                                                                                                       | Check above, then check if the HCAT token contract deployment was successful with correct state variable values                                                                                                                                                                                                                                                                                                                                                                    |
| getTokenContractDetails       | tokenCtrtAddr                                                                                                                                                                                                                                                                                                                                                    | Get HCAT token contract details                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| checkDeployedContracts        | symbol                                                                                                                                                                                                                                                                                                                                                           | Check all deployed smart contracts with given symbol                                                                                                                                                                                                                                                                                                                                                                                                                               |
| setTokenController            | tokenControllerCtrtAddr                                                                                                                                                                                                                                                                                                                                          | Set token state inside TokenController to ‘normal’                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| addProductRowFromSymbol       | tokenSymbol, tokenName, location, duration, fundingType, pricingCurrency, fundmanagerIn, TimeReleaseDateIn, notarizedRentalContract, BOEApprovedLetter, powerPurchaseAgreement, onGridTryrunLetter, powerPlantEquipmentRegisteredLetter, powerPlantInsurancePolicy, forecastedAnnualIncomePerModule, img1, img2, img3, img4, img5, img6, img7, img8, img9, img10 | Add a product into product table                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| checkArgumentsIncomeManager   | argsIncomeManager                                                                                                                                                                                                                                                                                                                                                | Check if the argument has correct values for Income Manager contract deployment                                                                                                                                                                                                                                                                                                                                                                                                    |
| deployIncomeManagerContract   | argsIncomeManager                                                                                                                                                                                                                                                                                                                                                | Deploy Income Manager contract with given arguments                                                                                                                                                                                                                                                                                                                                                                                                                                |
| checkDeploymentIncomeManager  | IncomeManager_Addr, argsIncomeManager                                                                                                                                                                                                                                                                                                                            | Check above, then check if the Income Manager contract deployment was successful with correct state variable values                                                                                                                                                                                                                                                                                                                                                                |
| getFundingStateCFC            | crowdFundingAddr                                                                                                                                                                                                                                                                                                                                                 | Get funding state from given crowdfunding contract address.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| getHeliumAddrCFC              | crowdFundingAddr                                                                                                                                                                                                                                                                                                                                                 | Get Helium contract address recorded inside given crowdfunding contract                                                                                                                                                                                                                                                                                                                                                                                                            |
| updateFundingStateCFC         | crowdFundingAddr, serverTime, symbol                                                                                                                                                                                                                                                                                                                             | Update funding state inside crowdfunding contract                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| getTokenStateTCC              | tokenControllerAddr                                                                                                                                                                                                                                                                                                                                              | Get token state from token controller contract                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| getHeliumAddrTCC              | tokenControllerAddr                                                                                                                                                                                                                                                                                                                                              | Get Helium contract address from given token controller contract                                                                                                                                                                                                                                                                                                                                                                                                                   |
| updateTokenStateTCC           | tokenControllerAddr, serverTime, symbol                                                                                                                                                                                                                                                                                                                          | Update token controller state                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| getCFC_Balances               | crowdFundingAddr, assetbooks                                                                                                                                                                                                                                                                                                                                     | Get crowdfunding invested balances for each given assetbook addresses                                                                                                                                                                                                                                                                                                                                                                                                              |
| getTokenBalances              | tokenCtrtAddr, assetbooks                                                                                                                                                                                                                                                                                                                                        | Got HCAT token balances for each given assetbook addresses                                                                                                                                                                                                                                                                                                                                                                                                                         |
| showAssetBookBalance_TokenId  | \-                                                                                                                                                                                                                                                                                                                                                               | Show test assetbook balances                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| sequentialCheckBalances       | addressArray, tokenCtrtAddr                                                                                                                                                                                                                                                                                                                                      | Get HCAT token balances for each given input address                                                                                                                                                                                                                                                                                                                                                                                                                               |
| sequentialCheckBalancesAfter  | addressArray, amountArray, tokenCtrtAddr, balanceArrayBefore, isToMax                                                                                                                                                                                                                                                                                            | Check the result of minting tokens: For each input address, compare balance before and balance now, then decide if the token minting result is successful                                                                                                                                                                                                                                                                                                                          |
| checkMint                     | tokenCtrtAddr, toAddress, amount, price, fundingType, serverTime                                                                                                                                                                                                                                                                                                 | Check tokenMinting operation by 1. Check mint-to addresses 2. Check all the require statements inside given HCAT contract mintTokens function                                                                                                                                                                                                                                                                                                                                      |
| sequentialMintToAdd           | addressArray, amountArray, maxMintAmountPerRun, fundingType, price, tokenCtrtAddr, serverTime                                                                                                                                                                                                                                                                    | Mint tokens by adding given amount of tokens to each address Danger. This function is likely to mint extra tokens if the previous token minting is unsuccessful, e.g. server crashes                                                                                                                                                                                                                                                                                               |
| sequentialMintToMax           | addressArray, amountArray, maxMintAmountPerRun, fundingType, price, tokenCtrtAddr, serverTime                                                                                                                                                                                                                                                                    | Mint tokens by adding to a fixed given amount of tokens to each address In case of errors occurring during tokenMinting process, we can restart the backend server to call this function again with the same argument, so it will find the remaining token amount for each to-address, then mint the correct amounts accordingly                                                                                                                                                   |
|                               |                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| preMint                       | symbol                                                                                                                                                                                                                                                                                                                                                           | Collect all arguments for minting tokens of given symbol: addressArray, amountArray, tokenCtrtAddr, fundingType, pricing                                                                                                                                                                                                                                                                                                                                                           |
| mintSequentialPerContract     | symbol, serverTime, maxMintAmountPerRun                                                                                                                                                                                                                                                                                                                          | Mint tokens for the whole crowdfunding contract:                                    1. preMint() to collect all arguments, 2. doAssetRecords() to add new asset records into DB, 3. updateIAassetRecordStatus(), 4. sequentialMintSuper(), 5. Call sequentialMintToMax, 6. Check after minting balances                                                                                                                                                                                                                                                                                                                                                                                                |
| sequentialMintSuper           | addressArray, amountArray, tokenCtrtAddr, fundingType, pricing, maxMintAmountPerRun, serverTime                                                                                                                                                                                                                                                                  | Check input values                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| sequentialRunTsMain           | mainInputArray, waitTime, serverTime, extraInputArray                                                                                                                                                                                                                                                                                                            | Will execute various actions according to the contract type. Actions including mintTokenToEachBatch, updateExpiredOrders, send time to contracts to get the new state: e.g. fundingState, tokenState                                                                                                                                                                                                                                                                               |
| mintToken                     | amountToMint, tokenCtrtAddr, to, fundingType, price                                                                                                                                                                                                                                                                                                              | Mint tokens directly via calling the mintSerialNFT() function on the HCAT contract                                                                                                                                                                                                                                                                                                                                                                                                 |
| mintTokensWithRegulationCheck | amount, tokenCtrtAddr, \_to, fundingType, price, tokenControllerAddr                                                                                                                                                                                                                                                                                             | To show more checks via checkMintSerialNFT() during token minting process For testing regulated amount of token minting                                                                                                                                                                                                                                                                                                                                                            |
| doAssetRecords                | addressArray, amountArray, serverTime, symbol, pricing                                                                                                                                                                                                                                                                                                           | Get Assetbook addresses, then find email addresses Get token balance for that symbol Get max Actual Payment Time and actualPayment ar_time = serverTime, tokenHoldingAmount Add in IncomeArrangement Table: Asset Record Status = 1                                                                                                                                                                                                                                                |
| updateFundingStateFromDB      | serverTime                                                                                                                                                                                                                                                                                                                                                       | Update crowdfunding contract funding state from checking database product table funding state and server time. \# Find symbols that have passed CFSD but their p_state are still in ‘initial’ state \# Find symbols that have passed CFED but their p_state are still in ‘funding’ or ‘fundingGoalReached’ state \# Then call updateFundingStateCFC() to update that symbol’s crowdfunding contract                                                                                |
| makeOrdersExpiredCFED         | serverTime                                                                                                                                                                                                                                                                                                                                                       | Make orders expired due to servertime reaching CFED inside database product table \# Find symbols that have passed CFED but their p_state are still in ‘initial’, ‘funding’, or ‘fundingGoalReached’ \# Set all orders with the found symbols and paymentStatus as ‘waiting’ to be paymentStatus as ‘expired’ inside database order_list table                                                                                                                                     |
| addUsersToRegistryCtrt        | registryCtrtAddr, userIDs, assetbooks, authLevels                                                                                                                                                                                                                                                                                                                | Add user ID numbers, assetbook addresses, authorized levels into Registry contract                                                                                                                                                                                                                                                                                                                                                                                                 |
| setUsersInRegistryCtrt        | registryCtrtAddr, userIDs, assetbooks, authLevels                                                                                                                                                                                                                                                                                                                | Set users inside Registry contract with matched userID to new given assetbook addresses and authLevels                                                                                                                                                                                                                                                                                                                                                                             |
| addAssetbooksIntoCFC          | serverTime, paymentStatus                                                                                                                                                                                                                                                                                                                                        | \# Find all the unique symbols with given paymentStatus value inside order_list table [TO BE DONE]\# Check for Crowdfunding contract token status if the status is normal \# Find all the assetbook addresses, emails, token counts, orderID with given payment status. \# Check if crowdingfunding contract funding status is valid \# Call investToken() to add paid orders into crowdfunding contract \# Set payment status to ‘txnFinished’ if all is successful inside order_list table, if not successful, set payment status to ‘errCFC’ |
| investTokens                  | crowdFundingAddr, addrAssetbookX, amountToInvestStr, serverTime, invokedBy | Call the invest() function inside the crowdfunding contract with write given assetbook address and buyTokenAmount, serverTime into that Crowdfunding contract                                                                                                                                                                                                                                                                                                                      |
| tokenReceiver                 | addrAssetbookX                                                                                                                                                                                                                                                                                                                                                   | Check if the address has a assetbook contract, which has correct state variables                                                                                                                                                                                                                                                                                                                                                                                                   |
| checkAssetbookArray           | addrAssetbookArray                                                                                                                                                                                                                                                                                                                                               | Check multiple assetbook addresses using above function                                                                                                                                                                                                                                                                                                                                                                                                                            |
| checkInvest                   | crowdFundingAddr, addrAssetbook, amountToInvestStr, serverTime                                                                                                                                                                                                                                                                                                   | Check all the require statements inside given Crowdfunding contract invest() function, if any of the require statement is evaluated to be false, then it will tell you which require statement failed and why it failed.                                                                                                                                                                                                                                                           |
| investTokensInBatch           | crowdFundingAddr, addrAssetbookArray, amountToInvestArray, serverTime                                                                                                                                                                                                                                                                                            | Invest with multiple assetbooks and their buyAmounts respectively using investInBatch() function in the crowdfunding contract                                                                                                                                                                                                                                                                                                                                                      |
| getDetailsCFC                 | crowdFundingAddr                                                                                                                                                                                                                                                                                                                                                 | Get all state variables from the given crowdfunding contract address                                                                                                                                                                                                                                                                                                                                                                                                               |
| getInvestorsFromCFC           | crowdFundingAddr, indexStartStr = 0, tokenCountStr = 0                                                                                                                                                                                                                                                                                                           | Get investor assetbook addresses from the given crowdfunding contract address with optional filter feature                                                                                                                                                                                                                                                                                                                                                                         |



| Function Name                    | Parameters                                               | Description                                                                                                                                                                                                                                                                                                                                                                                          |
|----------------------------------|----------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| setTimeCFC                       | crowdFundingAddr, serverTime                             | Set the crowdfunding state by entering a new time                                                                                                                                                                                                                                                                                                                                                    |
| setTimeCFC_bySymbol              | serverTime, symbol                                       | Set the crowdfunding state by given time and symbol                                                                                                                                                                                                                                                                                                                                                  |
| updateTokenStateFromDB           | serverTime                                               | Update token controller contract token state from checking database product table token state and server time. \# Find symbols that have passed p_lockuptime but their p_tokenState are still in ‘lockup’ state \# Find symbols that have passed p_validdate but their p_tokenState are still in ‘normal’ state \# Then call updateTokenStateTCC() to update that symbol’s token controller contract |
| writeToBlockchainAndDatabase     | targetAddr, serverTime, symbol, actionType               | Write state variables into blockchain smart contracts and database, e.g. funding state or token state                                                                                                                                                                                                                                                                                                |
| getIncomeManagerDetails          | addrIncomeManager                                        | Get state variables from given income manager contract address                                                                                                                                                                                                                                                                                                                                       |
| get_schCindex                    | symbol                                                   | Get schedule index inside income manager contract                                                                                                                                                                                                                                                                                                                                                    |
| tokenCtrt                        | symbol                                                   | Get token contract inside income manager contract                                                                                                                                                                                                                                                                                                                                                    |
| get_paymentCount                 | symbol                                                   | Get payment count inside income manager contract                                                                                                                                                                                                                                                                                                                                                     |
| get_TimeOfDeployment             | symbol                                                   | Get time of deployment inside income manager contract                                                                                                                                                                                                                                                                                                                                                |
| getIncomeSchedule                | Symbol, schIndex                                         | Get an income schedule inside income manager contract                                                                                                                                                                                                                                                                                                                                                |
| getIncomeScheduleList            | symbol, indexStart, amount                               | Get income schedule list inside income manager contract                                                                                                                                                                                                                                                                                                                                              |
| checkAddForecastedScheduleBatch1 | symbol, forecastedPayableTimes, forecastedPayableAmounts | Check add_forecasted_schedule_batch for any require statement error inside income manager contract                                                                                                                                                                                                                                                                                                   |
| checkAddForecastedScheduleBatch2 | symbol, forecastedPayableTimes, forecastedPayableAmounts | Check add_forecasted_schedule_batch2 for any require statement error inside income manager contract                                                                                                                                                                                                                                                                                                  |
| checkAddForecastedScheduleBatch  | symbol, forecastedPayableTimes, forecastedPayableAmounts | Check add_forecasted_schedule_batch for any require statement error inside income manager contract                                                                                                                                                                                                                                                                                                   |
| addForecastedScheduleBatch       | symbol, forecastedPayableTimes, forecastedPayableAmounts | Add forecasted schedule in batch                                                                                                                                                                                                                                                                                                                                                                     |
| addForecastedScheduleBatchFromDB | symbol                                                   | Add saved data in database into income manager contract as forecasted schedules in batch                                                                                                                                                                                                                                                                                                             |
| editActualSchedule               | symbol, schIndex, actualPaymentTime, actualPaymentAmount | Edit actual income schedule                                                                                                                                                                                                                                                                                                                                                                          |
| addPaymentCount                  | symbol                                                   | Add payment count                                                                                                                                                                                                                                                                                                                                                                                    |
| setErrResolution                 | symbol, schIndex, isErrorResolved, errorCode             | Set error resolution code for a chosen income schedule                                                                                                                                                                                                                                                                                                                                               |
| updateExpiredOrders              | serverTime                                               | Update expidred orders: 1.Find orderIDs, purchase dates from order_list within orders in ‘waiting’ as payment status   2.Check those order’s age.  3.Set payment status to expired if the order age is equal or over 3 days old  |
|  filterSymbols | array of symbols or array of symbol objects | filtered symbol array |
| getRestrictions | registryContractAddr, authLevel | get new restriction details |
| setRestrictions | registryContractAddr, authLevel, maxBuyAmountPublic, maxBalancePublic, maxBuyAmountPrivate, maxBalancePrivate | set new restriction details |


**Functions regarding Assetbook contracts**

| Function Names                     | Parameters                                                                                            | Descriptions                                                                              |
|------------------------------------|-------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
| get_assetOwner                     | addrAssetBook                                                                                         | Get the asset owner EOA saved inside given assetbook address                              |
| get_lastLoginTime                  | addrAssetBook                                                                                         | Get the last login time inside given assetbook address                                    |
| checkIsContract                    | addrAssetBook, assetAddr                                                                              | Check if input address has a contract deployed in it                                      |
| getAssetbookDetails                | addrAssetBook                                                                                         | Get all the state variables from given assetbook address                                  |
| endorsers                          | addrAssetBook                                                                                         | Get all endorsers’ addresses                                                              |
| setHeliumAddr                      | addrAssetBook, \_addrHeliumContract                                                                   | Set new Helium contract address inside given asset book contract                          |
| HeliumContractVote                 | addrAssetBook, serverTime                                                                             | For a customer service representative to vote                                             |
| resetVoteStatus                    | addrAssetBook                                                                                         | Reset all the votes to zero                                                               |
| changeAssetOwner                   | addrAssetBook, \_assetOwnerNew, serverTime                                                            | Change assetbook owner address                                                            |
| checkSafeTransferFromBatchFunction | assetIndex, addrHCAT721, fromAssetbook, toAssetbook, amount, price, serverTime                        | Check all arguments by using checkSafeTransferFromBatch() inside assetbook smart contract |
| transferTokens                     | addrHCAT721, fromAssetbook, toAssetbook, amountStr, priceStr, \_fromAssetOwner, \_fromAssetOwnerpkRaw | Transfer HCAT tokens                                                                      |
| rabbitMQSender                     | functionName, symbol, price                                                                           | Testing RabbitMQ sender fuction                                                           |
| rabbitMQReceiver                   | functionName, symbol, price                                                                           | Testing RabbitMQ receive function                                                         |
| signTx                             | userEthAddr, userRawPrivateKey, contractAddr, encodedData                                             | Use Ethereum-Tx.js to sign then send transactions                                         |
